import{c as b,j as t,r as s}from"./client-BCr4-QWM.js";import{g as j,s as E}from"./storage-uVl3v7f4.js";function T(){const[f,g]=s.useState([]),[a,r]=s.useState(1),[m,l]=s.useState(),[c,o]=s.useState(null);s.useEffect(()=>{const e=()=>g(window.speechSynthesis.getVoices());if(e(),speechSynthesis.onvoiceschanged===null)return speechSynthesis.addEventListener("voiceschanged",e),()=>speechSynthesis.removeEventListener("voiceschanged",e);speechSynthesis.onvoiceschanged=e},[]),s.useEffect(()=>{j().then(e=>{r(e.rate),l(e.voice)})},[]),s.useEffect(()=>{let e=!0;const n=()=>{try{chrome.runtime.sendMessage({action:"probe-tts"},i=>{e&&(i&&i.ok?o(!0):o(!1))})}catch(i){if(!e)return;console.warn("readit: probe-tts failed",i),o(!1)}};n();const u=()=>n();return window.addEventListener("focus",u),()=>{e=!1,window.removeEventListener("focus",u)}},[]);async function y(){try{await chrome.runtime.sendMessage({kind:"READ_SELECTION"})}catch(e){console.warn("readit: failed to request background read",e)}}async function d(e){await E(e)}const h={display:"block",fontWeight:600},v={width:"100%",padding:"12px",fontSize:"1rem"},S={width:"100%",padding:8},x={width:"100%"};return t.jsxs("div",{role:"application",style:{minWidth:280,padding:12,lineHeight:1.4},children:[t.jsx("h1",{style:{fontSize:"1.1rem",margin:"0 0 8px"},children:"Read It"}),t.jsx("button",{onClick:y,"aria-label":"Read selected text",style:v,children:"Read selection (Alt+Shift+R)"}),t.jsxs("div",{style:{marginTop:12},children:[t.jsx("label",{htmlFor:"voice",style:h,children:"Voice"}),t.jsxs("select",{id:"voice",value:m??"",onChange:e=>{l(e.target.value||void 0),d({voice:e.target.value||void 0})},style:S,children:[t.jsx("option",{value:"",children:"System default"}),f.map(e=>t.jsxs("option",{value:e.name,children:[e.name," ",e.lang?`(${e.lang})`:""]},e.name))]})]}),t.jsxs("div",{style:{marginTop:12},children:[t.jsxs("label",{htmlFor:"rate",style:h,children:["Rate: ",a.toFixed(2)]}),t.jsx("input",{id:"rate",type:"range",min:.5,max:2,step:.05,value:a,onChange:e=>{const n=Number(e.target.value);r(n),d({rate:n})},style:x})]}),t.jsx("p",{style:{fontSize:".85rem",marginTop:12},children:"Tip: Everything here is fully keyboard accessible. Use Tab / Shift+Tab to move, Space/Enter to activate."}),c===!1&&t.jsx("div",{style:{marginTop:12,padding:8,background:"#fff4f4",color:"#8b0000",borderRadius:4},children:"Local TTS helper not running. Start the helper (see project scripts/README.md) if you rely on local system voices."}),c===!0&&t.jsx("div",{style:{marginTop:12,padding:8,background:"#f4fff7",color:"#006400",borderRadius:4},children:"Local TTS helper available."})]})}const p=document.getElementById("root");p&&b.createRoot(p).render(t.jsx(T,{}));
